# Dockerfile.dev
FROM node:18

# Define o diretÃ³rio de trabalho
WORKDIR /app

# Copia apenas os arquivos de dependÃªncias primeiro (para otimizar o cache)
COPY package*.json ./

# Instala dependÃªncias
RUN npm install

# Copia o restante do cÃ³digo, incluindo a pasta prisma
COPY . .

# ğŸ”§ GARANTE que a pasta prisma e o schema sejam visÃ­veis
COPY prisma ./prisma

# ExpÃµe a porta
EXPOSE 3000

# Executa a migraÃ§Ã£o do Prisma antes de iniciar o servidor
CMD ["sh", "-c", "npx prisma migrate deploy && npm run dev"]
